<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"  
  "http://www.w3.org/TR/html4/loose.dtd">  
<html xml:lang="pt" > 
<head><title>Fatoraçao LU</title> 
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"> 
<meta name="generator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<meta name="originator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<!-- html,3,notoc*,info --> 
<meta name="src" content="main.tex"> 
<meta name="date" content="2016-10-18 11:11:00"> 
<link rel="stylesheet" type="text/css" href="main.css"> 
</head><body 
>
   <!--l. 687--><div class="crosslinks"><p class="noindent">[<a 
href="mainli14.html" >next</a>] [<a 
href="mainse17.html" >prev</a>] [<a 
href="mainse17.html#tailmainse17.html" >prev-tail</a>] [<a 
href="#tailmainse18.html">tail</a>] [<a 
href="mainli10.html#mainse26.html" >up</a>] </p></div>
   <h3 class="sectionHead"><span class="titlemark">4.4   </span> <a 
 id="x45-630004.4"></a>Fatoração LU</h3>
<!--l. 688--><p class="noindent" >Considere um sistema linear onde a matriz <span 
class="lmmi-12">A </span>é
densa<span class="footnote-mark"><a 
href="main46.html#fn5x7"><sup class="textsuperscript">5</sup></a></span><a 
 id="x45-63001f5"></a> .
Para resolver o sistema, podemos transformar a matriz <span 
class="lmmi-12">A </span>nas matrizes <span 
class="lmmi-12">L</span>,
triangular inferior, e <span 
class="lmmi-12">U</span>, triangular superior de tal forma que <span 
class="lmmi-12">A </span><span 
class="rm-lmr-12">= </span><span 
class="lmmi-12">LU</span>.
<!--l. 690--><p class="indent" >   Sendo assim o sistema pode ser reescrito tal que <div class="eqnarray">
   <center class="math-display" >
<img 
src="main545x.png" alt="      Ax   =   b

  (LU )x   =   b
  L (Ux )  =   b

Ly = b     e     U x = y
" class="math-display" ></center>
</div>Assim ao invés de resolvermos o sistema original, devemos resolver um sistema
triangular inferior e um sistema triangular superior.
<!--l. 699--><p class="indent" >   A matriz <span 
class="lmmi-12">U </span>da fatoração<span class="footnote-mark"><a 
href="main47.html#fn6x7"><sup class="textsuperscript">6</sup></a></span><a 
 id="x45-63003f6"></a> 
<span 
class="lmmi-12">LU </span>é a matriz obtida ao final do escalonamento da matriz <span 
class="lmmi-12">A</span>.
                                                                          

                                                                          
<!--l. 701--><p class="indent" >   A matriz <span 
class="lmmi-12">L </span>inicia igual a identidade <span 
class="lmmi-12">I</span>. Os elementos da matriz <span 
class="lmmi-12">L </span>são os
múltiplos do primeiro elemento da linha de <span 
class="lmmi-12">A </span><span class="underline">a ser zerado</span> dividido pelo pivô
acima na mesma coluna.
<!--l. 703--><p class="indent" >   Por exemplo, para zerar o primeiro elemento da segunda linha de <span 
class="lmmi-12">A</span>,
calculamos
   <center class="math-display" >
<img 
src="main546x.png" alt="L21 = A21 &#x2215;A11   " class="math-display" ></center> e
fazemos
   <center class="math-display" >
<img 
src="main547x.png" alt="A2,: &lArr; A2,: &minus; L21A1,:
" class="math-display" ></center>
<!--l. 708--><p class="indent" >   Note que usaremos <span 
class="lmmi-12">A</span><sub><span 
class="lmmi-8">i,</span><span 
class="rm-lmr-8">:</span></sub> para nos referenciarmos a linha <span 
class="lmmi-12">i </span>de <span 
class="lmmi-12">A</span>. Da mesma
forma, se necessário usaremos <span 
class="lmmi-12">A</span><sub><span 
class="rm-lmr-8">:</span><span 
class="lmmi-8">,j</span></sub> para nos referenciarmos a linha <span 
class="lmmi-12">j </span>de
<span 
class="lmmi-12">A</span>.
<!--l. 710--><p class="indent" >   Para zerar o primeiro elemento da terceira linha de <span 
class="lmmi-12">A</span>, temos
   <center class="math-display" >
<img 
src="main548x.png" alt="L31 = A31 &#x2215;A11   " class="math-display" ></center> e
fazemos
   <center class="math-display" >
<img 
src="main549x.png" alt="A3,: &lArr; A3,: &minus; L31A1,:   " class="math-display" ></center> até
chegarmos ao último elemento da primeira coluna de <span 
class="lmmi-12">A</span>.
<!--l. 716--><p class="indent" >   Repetimos o processo para as próximas colunas,
escalonando a matriz <span 
class="lmmi-12">A </span>e coletando os elementos <span 
class="lmmi-12">L</span><sub><span 
class="lmmi-8">ij</span></sub> abaixo da
diagonal<span class="footnote-mark"><a 
href="main48.html#fn7x7"><sup class="textsuperscript">7</sup></a></span><a 
 id="x45-63004f7"></a> .
   <h4 class="subsectionHead"><span class="titlemark">4.4.1   </span> <a 
 id="x45-640004.4.1"></a>Algoritmo para fatoração LU</h4>
<!--l. 723--><p class="noindent" >O algoritmo para fatoração <span 
class="lmmi-12">LU </span>pode ser escrito como
                                                                          

                                                                          
   <div class="verbatim" id="verbatim-24">
&#x00A0;1.&#x00A0;function&#x00A0;[L,A]=fatoraLU(A)
&#x00A0;<br />&#x00A0;2.&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;n=size(A,1)
&#x00A0;<br />&#x00A0;3.&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;L=eye(n,n)
&#x00A0;<br />&#x00A0;4.&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;for&#x00A0;j=1:n-1
&#x00A0;<br />&#x00A0;5.&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;for&#x00A0;i=j+1:n
&#x00A0;<br />&#x00A0;6.&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;L(i,j&#x00A0;&#x00A0;&#x00A0;&#x00A0;)=A(i,j)/A(j,j)
&#x00A0;<br />&#x00A0;7.&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;A(i,j+1:n)=A(i,j+1:n)-L(i,j)*A(j,j+1:n)
&#x00A0;<br />&#x00A0;8.&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;A(i,j&#x00A0;&#x00A0;&#x00A0;&#x00A0;)=0
&#x00A0;<br />&#x00A0;9.&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;end
&#x00A0;<br />10.&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;end
&#x00A0;<br />11.&#x00A0;endfunction
</div>
<!--l. 736--><p class="nopar" >
<!--l. 738--><p class="noindent" >
   <h5 class="subsubsectionHead"><a 
 id="x45-650004.4.1"></a>Custo computacional</h5>
<!--l. 739--><p class="noindent" >Podemos analisar o custo computacional reduzindo o problema em problemas
menores.
<!--l. 741--><p class="indent" >   Na linha 4, iniciamos com <span 
class="lmmi-12">j </span><span 
class="rm-lmr-12">= 1</span>. Desta forma <span 
class="lmmi-12">i </span>varia de <span 
class="rm-lmr-12">2 </span>até <span 
class="lmmi-12">n </span>na linha
5.
<!--l. 743--><p class="indent" >   A linha 6 terá sempre 1 flop.
<!--l. 745--><p class="indent" >   A linha 7, com <span 
class="lmmi-12">j </span><span 
class="rm-lmr-12">= 1 </span>tem um bloco de tamanho <span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-12">2:n</span></span></span> contabilizando <span 
class="lmmi-12">n</span><span 
class="lmsy-10x-x-120">&minus; </span><span 
class="rm-lmr-12">1 </span>flops
do produto e <span 
class="lmmi-12">n </span><span 
class="lmsy-10x-x-120">&minus; </span><span 
class="rm-lmr-12">1 </span>flops da subtração.
<!--l. 747--><p class="indent" >   Nas linhas 6-8 são feitas <span 
class="rm-lmr-12">(2(</span><span 
class="lmmi-12">n</span><span 
class="lmsy-10x-x-120">&minus; </span><span 
class="rm-lmr-12">1) + 1) = 2</span><span 
class="lmmi-12">n</span><span 
class="lmsy-10x-x-120">&minus; </span><span 
class="rm-lmr-12">1 </span>flops independente do valor de
<span 
class="lmmi-12">i</span>. Como <span 
class="lmmi-12">i </span>varia de <span 
class="rm-lmr-12">2 </span>até <span 
class="lmmi-12">n</span>, teremos que o bloco é repetido <span 
class="lmmi-12">n </span><span 
class="lmsy-10x-x-120">&minus; </span><span 
class="rm-lmr-12">1 </span>vezes, ou seja, o
custo das linhas 5-9 é
   <table 
class="equation"><tr><td><a 
 id="x45-65001r21"></a>
   <center class="math-display" >
                                                                          

                                                                          
<img 
src="main550x.png" alt="                                   2
(n &minus; 1) &#x00D7; (2(n &minus; 1) + 1) = 2(n &minus; 1) +  (n &minus; 1)
" class="math-display" ></center></td><td class="equation-label">(4.21)</td></tr></table>
<!--l. 750--><p class="nopar" >
<!--l. 752--><p class="indent" >   Voltamos a linha 4 quando <span 
class="lmmi-12">j </span><span 
class="rm-lmr-12">= 2</span>. Das linhas 6-8 teremos <span 
class="lmmi-12">n </span><span 
class="lmsy-10x-x-120">&minus; </span><span 
class="rm-lmr-12">2 </span>flops (o bloco
terá um elemento a menos) que será repetido <span 
class="lmmi-12">n </span><span 
class="lmsy-10x-x-120">&minus; </span><span 
class="rm-lmr-12">2 </span>vezes, pois <span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-12">i=3:n</span></span></span>, ou
seja,
   <table 
class="equation"><tr><td><a 
 id="x45-65002r22"></a>
   <center class="math-display" >
<img 
src="main551x.png" alt="(n &minus; 2) &#x00D7; (2(n &minus; 2) + 1) = 2(n &minus; 2)2 + (n &minus; 2)
" class="math-display" ></center></td><td class="equation-label">(4.22)</td></tr></table>
<!--l. 755--><p class="nopar" >
<!--l. 757--><p class="indent" >   Para <span 
class="lmmi-12">j </span><span 
class="rm-lmr-12">= 3</span>, temos <span 
class="rm-lmr-12">2(</span><span 
class="lmmi-12">n </span><span 
class="lmsy-10x-x-120">&minus; </span><span 
class="rm-lmr-12">3)</span><sup><span 
class="rm-lmr-8">2</span></sup> <span 
class="rm-lmr-12">+ (</span><span 
class="lmmi-12">n </span><span 
class="lmsy-10x-x-120">&minus; </span><span 
class="rm-lmr-12">3)</span>.
<!--l. 759--><p class="indent" >   Para <span 
class="lmmi-12">j </span><span 
class="rm-lmr-12">= </span><span 
class="lmmi-12">n </span><span 
class="lmsy-10x-x-120">&minus; </span><span 
class="rm-lmr-12">2</span>, temos <span 
class="rm-lmr-12">2(2)</span><sup><span 
class="rm-lmr-8">2</span></sup> <span 
class="rm-lmr-12">+ 2</span>.
<!--l. 761--><p class="indent" >   Finalmente, para <span 
class="lmmi-12">j </span><span 
class="rm-lmr-12">= </span><span 
class="lmmi-12">n </span><span 
class="lmsy-10x-x-120">&minus; </span><span 
class="rm-lmr-12">1</span>, temos <span 
class="rm-lmr-12">2 </span><span 
class="lmsy-10x-x-120">&sdot; </span><span 
class="rm-lmr-12">1</span><sup><span 
class="rm-lmr-8">2</span></sup> <span 
class="rm-lmr-12">+ 1</span>.
<!--l. 764--><p class="indent" >   Somando todos esses custos, temos <div class="eqnarray">
   <center class="math-display" >
<img 
src="main552x.png" alt="                  2                       2                 2
(n &minus; 1) + 2(n &minus; 1)   +   (n &minus;  2) + 2(n &minus; 2 ) + ...+ (2) + 2(2) + 1 + 2 &sdot; 1
                         n&sum;&minus;1  2
                     =      2k  + k
                         k=1
                          n&sum;&minus;1  2  n&minus;&sum; 1
                     =   2    k +     k
                          k=1     k=1
                          (n-&minus;-1)n(2n-&minus;-1-)   n(n-&minus;-1)-
                     =   2        6        +     2
                         2n3   n2    n
                     =   ----&minus; ---&minus;  --flops.
                          3     2    6
" class="math-display" ></center>
</div>
<!--l. 784--><p class="noindent" >
   <h4 class="subsectionHead"><span class="titlemark">4.4.2   </span> <a 
 id="x45-660004.4.2"></a>Custo computacional para resolver um sistema linear usando fatoração
LU</h4>
<!--l. 785--><p class="noindent" >Para calcularmos o custo computacional de um algoritmo completo, uma
estratégia é separar o algoritmo em partes menores mais fáceis de calcular.
<!--l. 787--><p class="indent" >   Para resolver o sistema, devemos primeiro fatorar a matriz <span 
class="lmmi-12">A </span>nas matrizes <span 
class="lmmi-12">L </span>e
<span 
class="lmmi-12">U</span>. Vimos que o custo é
   <center class="math-display" >
<img 
src="main553x.png" alt="   3    2
2n--&minus;  n--&minus; n- flops.
 3      2    6
" class="math-display" ></center>
<!--l. 790--><p class="indent" >   Depois devemos resolver os sistemas <span 
class="lmmi-12">Ly </span><span 
class="rm-lmr-12">= </span><span 
class="lmmi-12">b </span>e <span 
class="lmmi-12">Ux </span><span 
class="rm-lmr-12">= </span><span 
class="lmmi-12">y</span>. O custo de resolver os
dois sistemas é (devemos contar duas vezes)
                                                                          

                                                                          
   <center class="math-display" >
<img 
src="main554x.png" alt="   2
2n   flops.
" class="math-display" ></center>
<!--l. 793--><p class="indent" >   Somando esses <span 
class="rm-lmr-12">3 </span>custos, temos que o custo para resolver um sistema linear
usando fatoração <span 
class="lmmi-12">LU </span>é
   <center class="math-display" >
<img 
src="main555x.png" alt="2n3   3n2    n
----+ ----&minus;  --flops.
 3      2    6
" class="math-display" ></center>
<!--l. 796--><p class="indent" >   Quando <span 
class="lmmi-12">n </span>cresce, prevalessem os termos de mais alta ordem, ou seja,
   <center class="math-display" >
<img 
src="main556x.png" alt="     3      2              3      2         3
O (2n--+  3n--&minus; n-) = O( 2n--+ 3n--) = O( 2n-)
    3      2    6         3     2          3
" class="math-display" ></center>
                                                                          

                                                                          
<!--l. 799--><p class="noindent" >
   <h4 class="subsectionHead"><span class="titlemark">4.4.3   </span> <a 
 id="x45-670004.4.3"></a>Custo para resolver m sistemas lineares</h4>
<!--l. 800--><p class="noindent" >Devemos apenas multiplicar <span 
class="lmmi-12">m </span>pelo custo de resolver um sistema linear usando
fatoração <span 
class="lmmi-12">LU</span>, ou seja, o custo será
   <center class="math-display" >
<img 
src="main557x.png" alt="   2n3   3n2    n     2mn3    3mn2     mn
m (----+ ----&minus;  --) = ------+ ------&minus;  ----
    3     2     6       3       2       6  " class="math-display" ></center> e
com <span 
class="lmmi-12">m </span><span 
class="rm-lmr-12">= </span><span 
class="lmmi-12">n </span>temos
   <center class="math-display" >
<img 
src="main558x.png" alt="  4      3     2
2n--+  3n--&minus; n--.
 3      2     6
" class="math-display" ></center>
<!--l. 805--><p class="indent" >   Porém, se estivermos resolvendo <span 
class="lmmi-12">n </span>sistemas com <span 
class="ec-lmri-12">a mesma matriz </span><span 
class="lmmi-12">A </span>(e
diferente lado direito <img 
src="main559x.png" alt="&#x20D7;b"  class="vec" > para cada sistema) podemos fazer a fatoração LU uma
única vez e contar apenas o custo de resolver os sistemas triangulares
obtidos.
<!--l. 807--><p class="indent" >   Custo para fatoração LU de <span 
class="lmmi-12">A</span>: <img 
src="main560x.png" alt="  3
2n3-"  class="frac" align="middle"> <span 
class="lmsy-10x-x-120">&minus;</span><img 
src="main561x.png" alt=" 2
n2"  class="frac" align="middle"> <span 
class="lmsy-10x-x-120">&minus;</span><img 
src="main562x.png" alt="n6"  class="frac" align="middle">.
<!--l. 809--><p class="indent" >   Custo para resolver <span 
class="lmmi-12">m </span>sistemas triangulares inferiores: <span 
class="lmmi-12">mn</span><sup><span 
class="rm-lmr-8">2</span></sup>.
<!--l. 811--><p class="indent" >   Custo para resolver <span 
class="lmmi-12">m </span>sistemas triangulares superiores: <span 
class="lmmi-12">mn</span><sup><span 
class="rm-lmr-8">2</span></sup>.
<!--l. 813--><p class="indent" >   Somando esses custos obtemos
                                                                          

                                                                          
   <center class="math-display" >
<img 
src="main563x.png" alt="   3    2
2n--&minus;  n--&minus; n-+  2mn2
 3     2    6   " class="math-display" ></center> que
quando <span 
class="lmmi-12">m </span><span 
class="rm-lmr-12">= </span><span 
class="lmmi-12">n </span>obtemos
   <center class="math-display" >
<img 
src="main564x.png" alt="8n3-   n2-  n-
 3  &minus;   2 &minus;  6 flops.
" class="math-display" ></center>
<!--l. 818--><p class="noindent" >
   <h4 class="subsectionHead"><span class="titlemark">4.4.4   </span> <a 
 id="x45-680004.4.4"></a>Custo para calcular a matriz inversa de <span 
class="lmmi-12">A</span></h4>
<!--l. 819--><p class="noindent" >Como vemos em Álgebra Linear, um método para obter a matriz <span 
class="lmmi-12">A</span><sup><span 
class="lmsy8-">&minus;</span><span 
class="rm-lmr-8">1</span></sup> é realizar o
escalonamento da matriz <span 
class="rm-lmr-12">[</span><span 
class="lmmi-12">A</span><span 
class="lmsy-10x-x-120">|</span><span 
class="lmmi-12">I</span><span 
class="rm-lmr-12">] </span>onde <span 
class="lmmi-12">I </span>é a matriz identidade. Ao terminar o
escalonamento, o bloco do lado direito conterá <span 
class="lmmi-12">A</span><sup><span 
class="lmsy8-">&minus;</span><span 
class="rm-lmr-8">1</span></sup>.
<!--l. 821--><p class="indent" >   Isto é equivalente a resolver <span 
class="lmmi-12">n </span>sistemas lineares com a mesma matriz <span 
class="lmmi-12">A </span>e os
vetores da base canônica <img 
src="main565x.png" alt="&#x20D7;e"  class="vec" ><sub><span 
class="lmmi-8">i</span></sub> <span 
class="rm-lmr-12">= [0</span><span 
class="lmmi-12">,...,</span><span 
class="rm-lmr-12">0</span><span 
class="lmmi-12">,</span><span 
class="rm-lmr-12">1</span><span 
class="lmmi-12">,</span><span 
class="rm-lmr-12">0</span><span 
class="lmmi-12">,....</span><span 
class="rm-lmr-12">0]</span><sup><span 
class="lmmi-8">T</span> </sup> tal que
   <center class="math-display" >
<img 
src="main566x.png" alt="A &#x20D7;xi = &#x20D7;ei,     i = 1 : n  " class="math-display" ></center>
onde <img 
src="main567x.png" alt="&#x20D7;x"  class="vec" ><sub><span 
class="lmmi-8">i</span></sub> serão as colunas da matriz <span 
class="lmmi-12">A </span>inversa, já que <span 
class="lmmi-12">AX </span><span 
class="rm-lmr-12">= </span><span 
class="lmmi-12">I</span>.
<!--l. 825--><p class="indent" >   O custo para resolver esses <span 
class="lmmi-12">n </span>sistemas lineares foi calculado na seção anterior
como
   <center class="math-display" >
<img 
src="main568x.png" alt="8n3    n2   n
----&minus;  ---&minus; --.
 3     2    6
" class="math-display" ></center>
   <div class="newtheorem">
<!--l. 828--><p class="noindent" ><span class="head">
<a 
 id="x45-68001r1"></a>
<span 
class="ec-lmbx-12">Exemplo 4.4.1.</span>  </span>Qual o melhor método para resolver um sistema linear: via
fatoração LU ou calculando a inversa de <span 
class="lmmi-12">A </span>e obtendo <span 
class="lmmi-12">x </span><span 
class="rm-lmr-12">= </span><span 
class="lmmi-12">A</span><sup><span 
class="lmsy8-">&minus;</span><span 
class="rm-lmr-8">1</span></sup><span 
class="lmmi-12">b</span>?
   </div>
                                                                          

                                                                          
   <!--l. 833--><div class="crosslinks"><p class="noindent">[<a 
href="mainli14.html" >next</a>] [<a 
href="mainse17.html" >prev</a>] [<a 
href="mainse17.html#tailmainse17.html" >prev-tail</a>] [<a 
href="mainse18.html" >front</a>] [<a 
href="mainli10.html#mainse26.html" >up</a>] </p></div>
<!--l. 833--><p class="indent" >   <a 
 id="tailmainse18.html"></a>   
</body></html> 
